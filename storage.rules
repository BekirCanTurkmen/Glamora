rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    
    // ✅ Kullanıcı klasörleri - Her kullanıcı sadece kendi klasörüne erişebilir
    match /glamora_users/{userId}/{allPaths=**} {
      // Okuma: Tüm giriş yapmış kullanıcılar görebilir (sosyal özellikler için)
      allow read: if request.auth != null;
      
      // Yazma: Sadece dosya sahibi yazabilir
      allow write: if request.auth != null && request.auth.uid == userId;
      
      // Ek güvenlik: Dosya boyutu kontrolü (max 10MB)
      allow write: if request.resource.size < 10 * 1024 * 1024;
      
      // İzin verilen dosya tipleri (sadece resimler)
      allow write: if request.resource.contentType.matches('image/.*');
    }
    
    // ✅ Public assets (logoler, vb.) - Herkes okuyabilir
    match /public/{allPaths=**} {
      allow read: if true;
      allow write: if false; // Sadece admin yazabilir
    }
  }
}
